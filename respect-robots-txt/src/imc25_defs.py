import re
import ipaddress

# https://openai.com/searchbot.json
OPENAI_SEARCHBOT_IPS = """
20.42.10.176/28
172.203.190.128/28
51.8.102.0/24
135.234.64.0/24
"""
OPENAI_SEARCHBOT_IP_RANGES = [ipaddress.ip_network(line.strip()) for line in OPENAI_SEARCHBOT_IPS.strip().splitlines()]

# https://openai.com/gptbot.json
OPENAI_GPTBOT_IPS = """
52.230.152.0/24
20.171.206.0/24
20.171.207.0/24
4.227.36.0/25
20.125.66.80/28
172.182.204.0/24
"""
OPENAI_GPTBOT_IP_RANGES = [ipaddress.ip_network(line.strip()) for line in OPENAI_GPTBOT_IPS.strip().splitlines()]

# Source: https://openai.com/chatgpt-user.json
OPENAI_CHATGPT_USER_IPS = """
23.98.179.16/28
172.183.222.128/28
40.116.73.208/28
52.190.190.16/28
51.8.155.64/28
51.8.155.48/28
135.237.131.208/28
51.8.155.112/28
52.159.249.96/28
52.255.111.112/28
172.178.141.112/28
172.178.140.144/28
172.178.141.128/28
4.196.118.112/28
20.215.188.192/28
4.197.22.112/28
172.213.21.16/28
172.213.12.112/28
57.154.175.0/28
52.236.94.144/28
23.98.186.192/28
23.98.186.176/28
68.221.67.192/28
13.83.167.128/28
52.159.227.32/28
137.116.165.208/28
68.221.67.224/28
20.97.189.96/28
52.230.163.32/28
52.255.111.80/28
4.151.241.240/28
52.255.111.48/28
52.230.164.176/28
20.161.75.208/28
52.225.75.208/28
52.156.77.144/28
40.84.221.208/28
40.84.221.224/28
"""
OPENAI_CHATGPT_USER_IP_RANGES = [ipaddress.ip_network(line.strip()) for line in OPENAI_CHATGPT_USER_IPS.strip().splitlines()]

# Merge
OPENAI_IP_RANGES = OPENAI_CHATGPT_USER_IP_RANGES + OPENAI_GPTBOT_IP_RANGES + OPENAI_SEARCHBOT_IP_RANGES

# Source: https://search.developer.apple.com/applebot.json
APPLEBOT_IPS = """
17.241.208.160/27
17.241.193.160/27
17.241.200.160/27
17.22.237.0/24
17.22.245.0/24
17.22.253.0/24
17.241.75.0/24
17.241.219.0/24
17.241.227.0/24
17.246.15.0/24
17.246.19.0/24
17.246.23.0/24
"""
APPLEBOT_IP_RANGES = [ipaddress.ip_network(line.strip()) for line in APPLEBOT_IPS.strip().splitlines()]

# Source: https://developers.facebook.com/docs/sharing/webmasters/web-crawlers/
META_IPS = """
31.13.24.0/21
31.13.64.0/18
31.13.64.0/19
31.13.64.0/24
31.13.65.0/24
31.13.66.0/24
31.13.67.0/24
31.13.68.0/24
31.13.69.0/24
31.13.70.0/24
31.13.71.0/24
31.13.72.0/24
31.13.73.0/24
31.13.74.0/24
31.13.75.0/24
31.13.76.0/24
31.13.77.0/24
31.13.78.0/24
31.13.79.0/24
31.13.80.0/24
31.13.81.0/24
31.13.82.0/24
31.13.83.0/24
31.13.84.0/24
31.13.85.0/24
31.13.86.0/24
31.13.87.0/24
31.13.88.0/24
31.13.89.0/24
31.13.90.0/24
31.13.91.0/24
31.13.92.0/24
31.13.93.0/24
31.13.94.0/24
31.13.95.0/24
31.13.96.0/19
45.64.40.0/22
57.141.0.0/24
57.141.0.0/24
57.141.1.0/24
57.141.1.0/24
57.141.2.0/24
57.141.2.0/24
57.141.3.0/24
57.141.3.0/24
57.141.4.0/24
57.141.4.0/24
57.141.5.0/24
57.141.5.0/24
57.141.6.0/24
57.141.6.0/24
57.141.7.0/24
57.141.7.0/24
57.141.8.0/24
57.141.8.0/24
57.141.9.0/24
57.141.9.0/24
57.141.10.0/24
57.141.10.0/24
57.141.11.0/24
57.141.11.0/24
57.141.12.0/24
57.141.13.0/24
57.141.13.0/24
57.144.0.0/14
57.144.0.0/23
57.144.2.0/23
57.144.4.0/23
57.144.6.0/23
57.144.8.0/23
57.144.10.0/23
57.144.12.0/23
57.144.14.0/23
57.144.16.0/23
57.144.18.0/23
57.144.20.0/23
57.144.22.0/23
57.144.24.0/23
57.144.26.0/23
57.144.28.0/23
57.144.30.0/23
57.144.32.0/23
57.144.34.0/23
57.144.36.0/23
57.144.38.0/23
57.144.40.0/23
57.144.42.0/23
57.144.44.0/23
57.144.46.0/23
57.144.48.0/23
57.144.50.0/23
57.144.52.0/23
57.144.54.0/23
57.144.56.0/23
57.144.58.0/23
57.144.60.0/23
57.144.62.0/23
57.144.64.0/23
57.144.66.0/23
57.144.68.0/23
57.144.70.0/23
57.144.72.0/23
57.144.74.0/23
57.144.76.0/23
57.144.78.0/23
57.144.80.0/23
57.144.82.0/23
57.144.84.0/23
57.144.86.0/23
57.144.88.0/23
57.144.90.0/23
57.144.92.0/23
57.144.94.0/23
57.144.96.0/23
57.144.98.0/23
57.144.100.0/23
57.144.102.0/23
57.144.104.0/23
57.144.106.0/23
57.144.108.0/23
57.144.110.0/23
57.144.112.0/23
57.144.114.0/23
57.144.116.0/23
57.144.118.0/23
57.144.120.0/23
57.144.122.0/23
57.144.124.0/23
57.144.126.0/23
57.144.128.0/23
57.144.130.0/23
57.144.132.0/23
57.144.134.0/23
57.144.136.0/23
57.144.138.0/23
57.144.140.0/23
57.144.142.0/23
57.144.144.0/23
57.144.146.0/23
57.144.148.0/23
57.144.150.0/23
57.144.152.0/23
57.144.154.0/23
57.144.156.0/23
57.144.158.0/23
57.144.160.0/23
57.144.162.0/23
57.144.164.0/23
57.144.166.0/23
57.144.168.0/23
57.144.170.0/23
57.144.172.0/23
57.144.174.0/23
57.144.176.0/23
57.144.178.0/23
57.144.180.0/23
57.144.182.0/23
57.144.184.0/23
57.144.186.0/23
57.144.188.0/23
57.144.190.0/23
57.144.192.0/23
57.144.194.0/23
57.144.196.0/23
57.144.198.0/23
57.144.200.0/23
57.144.202.0/23
66.220.144.0/20
66.220.144.0/21
66.220.152.0/21
69.63.176.0/20
69.63.176.0/20
69.63.176.0/21
69.63.184.0/21
69.171.224.0/19
69.171.224.0/20
69.171.239.0/24
69.171.240.0/20
69.171.250.0/24
69.171.255.0/24
74.119.76.0/22
102.132.96.0/20
102.132.96.0/24
102.132.97.0/24
102.132.99.0/24
102.132.100.0/24
102.132.101.0/24
102.132.103.0/24
102.132.104.0/24
103.4.96.0/22
129.134.0.0/16
129.134.0.0/17
129.134.25.0/24
129.134.26.0/24
129.134.27.0/24
129.134.28.0/24
129.134.29.0/24
129.134.30.0/23
129.134.30.0/24
129.134.31.0/24
129.134.64.0/24
129.134.65.0/24
129.134.66.0/24
129.134.67.0/24
129.134.68.0/24
129.134.69.0/24
129.134.70.0/24
129.134.71.0/24
129.134.72.0/24
129.134.73.0/24
129.134.74.0/24
129.134.75.0/24
129.134.76.0/24
129.134.77.0/24
129.134.78.0/24
129.134.79.0/24
129.134.112.0/24
129.134.113.0/24
129.134.114.0/24
129.134.115.0/24
129.134.127.0/24
147.75.208.0/20
147.75.208.0/20
157.240.0.0/16
157.240.0.0/17
157.240.0.0/24
157.240.1.0/24
157.240.2.0/24
157.240.3.0/24
157.240.5.0/24
157.240.6.0/24
157.240.7.0/24
157.240.8.0/24
157.240.9.0/24
157.240.10.0/24
157.240.11.0/24
157.240.12.0/24
157.240.13.0/24
157.240.14.0/24
157.240.15.0/24
157.240.16.0/24
157.240.17.0/24
157.240.18.0/24
157.240.19.0/24
157.240.20.0/24
157.240.21.0/24
157.240.22.0/24
157.240.23.0/24
157.240.24.0/24
157.240.25.0/24
157.240.26.0/24
157.240.27.0/24
157.240.28.0/24
157.240.29.0/24
157.240.30.0/24
157.240.31.0/24
157.240.96.0/24
157.240.97.0/24
157.240.98.0/24
157.240.99.0/24
157.240.100.0/24
157.240.101.0/24
157.240.192.0/18
157.240.192.0/24
157.240.193.0/24
157.240.194.0/24
157.240.195.0/24
157.240.196.0/24
157.240.197.0/24
157.240.198.0/24
157.240.199.0/24
157.240.200.0/24
157.240.201.0/24
157.240.202.0/24
157.240.203.0/24
157.240.204.0/24
157.240.205.0/24
157.240.206.0/24
157.240.207.0/24
157.240.208.0/24
157.240.209.0/24
157.240.210.0/24
157.240.211.0/24
157.240.212.0/24
157.240.213.0/24
157.240.214.0/24
157.240.215.0/24
157.240.216.0/24
157.240.217.0/24
157.240.218.0/24
157.240.219.0/24
157.240.220.0/24
157.240.221.0/24
157.240.222.0/24
157.240.223.0/24
157.240.224.0/24
157.240.225.0/24
157.240.226.0/24
157.240.227.0/24
157.240.228.0/24
157.240.229.0/24
157.240.231.0/24
157.240.232.0/24
157.240.233.0/24
157.240.234.0/24
157.240.235.0/24
157.240.236.0/24
157.240.237.0/24
157.240.238.0/24
157.240.239.0/24
157.240.240.0/24
157.240.241.0/24
157.240.242.0/24
157.240.243.0/24
157.240.244.0/24
157.240.245.0/24
157.240.246.0/24
157.240.247.0/24
157.240.248.0/24
157.240.249.0/24
157.240.250.0/24
157.240.251.0/24
157.240.252.0/24
157.240.253.0/24
157.240.254.0/24
163.70.128.0/17
163.70.128.0/24
163.70.129.0/24
163.70.130.0/24
163.70.131.0/24
163.70.132.0/24
163.70.133.0/24
163.70.134.0/24
163.70.135.0/24
163.70.136.0/24
163.70.137.0/24
163.70.138.0/24
163.70.139.0/24
163.70.140.0/24
163.70.141.0/24
163.70.142.0/24
163.70.143.0/24
163.70.144.0/24
163.70.145.0/24
163.70.146.0/24
163.70.147.0/24
163.70.148.0/24
163.70.149.0/24
163.70.150.0/24
163.70.151.0/24
163.70.152.0/24
163.70.153.0/24
163.70.158.0/24
163.70.159.0/24
163.77.128.0/17
173.252.64.0/18
173.252.64.0/19
173.252.88.0/21
173.252.96.0/19
179.60.192.0/22
179.60.192.0/24
179.60.193.0/24
179.60.194.0/24
179.60.195.0/24
185.60.216.0/22
185.60.216.0/24
185.60.217.0/24
185.60.218.0/24
185.60.219.0/24
185.89.216.0/22
185.89.216.0/22
185.89.218.0/23
185.89.218.0/23
185.89.218.0/24
185.89.218.0/24
185.89.219.0/24
185.89.219.0/24
204.15.20.0/22
"""
META_IP_RANGES = [ipaddress.ip_network(line.strip()) for line in META_IPS.strip().splitlines()]